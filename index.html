<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="UnityMappingFactory : Extension which allows you to register factories that will create new objects based on data from different existing objects essentially mapping between them." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>UnityMappingFactory</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/jigamiller/unitymappingfactory">View on GitHub</a>

          <h1 id="project_title">UnityMappingFactory</h1>
          <h2 id="project_tagline">Extension which allows you to register factories that will create new objects based on data from different existing objects essentially mapping between them.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/jigamiller/unitymappingfactory/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/jigamiller/unitymappingfactory/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>Adds an Extension method to the <a href="http://msdn.microsoft.com/en-us/library/microsoft.practices.unity.iunitycontainer.aspx">IUnityContainer</a> which allows you to register factories that will create new objects based on data from existing objects essentially mapping from one type hierarchy to a different type hierarchy.</p>

<p>The goal was simplicity and readability. No need to declare individual factory classes or even interfaces! Just add the mappings right where you register the classes during the normal bootstrapping process.</p>

<h2>
<a name="notes" class="anchor" href="#notes"><span class="octicon octicon-link"></span></a>NOTE(s):</h2>

<ul>
<li>You must register anything you are creating using the <a href="http://msdn.microsoft.com/en-us/library/ee649762.aspx">IUnityContainer.RegisterType</a> method in the container (aka. the generic <strong>TTo</strong> input). </li>
<li>You do NOT need to register anthying that you are mapping from (aka. the generic <strong>TFrom</strong> input).</li>
<li>You do NOT need to register any base or abstract types unless you are specifically creating them.</li>
</ul><h2>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Example(s):</h2>

<h4>
<a name="simple-1-class-to-1-class-mapping" class="anchor" href="#simple-1-class-to-1-class-mapping"><span class="octicon octicon-link"></span></a>Simple 1-class to 1-class mapping:</h4>

<div class="highlight"><pre><span class="c1">//make sure to register the output...</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterType</span><span class="p">&lt;</span><span class="n">IPersonViewModel</span><span class="p">,</span> <span class="n">PersonViewModel</span><span class="p">&gt;();</span>

<span class="c1">//define the mapping between classes...</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterFactory</span><span class="p">&lt;</span><span class="n">IPerson</span><span class="p">,</span> <span class="n">IPersonViewModel</span><span class="p">&gt;()</span>
    <span class="p">.</span><span class="n">AddDefaultMap</span><span class="p">();</span>
</pre></div>

<p>This will map any <strong>IPerson</strong> instances as a parameter that will be used to create any instances of the <strong>IPersonViewModel</strong>.</p>

<h4>
<a name="mapping-between-2-different-class-hierarchies" class="anchor" href="#mapping-between-2-different-class-hierarchies"><span class="octicon octicon-link"></span></a>Mapping between 2 different class hierarchies:</h4>

<div class="highlight"><pre><span class="c1">//make sure to register the output...</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterType</span><span class="p">&lt;</span><span class="n">IImageWidgetViewModel</span><span class="p">,</span> <span class="n">ImageWidgetViewModel</span><span class="p">&gt;();</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterType</span><span class="p">&lt;</span><span class="n">ITextWidgetViewModel</span><span class="p">,</span> <span class="n">TextWidgetViewModel</span><span class="p">&gt;();</span>

<span class="c1">//define the mapping between different class hierarchies...</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterFactory</span><span class="p">&lt;</span><span class="n">IWidget</span><span class="p">,</span> <span class="n">IWidgetViewModel</span><span class="p">&gt;()</span>
    <span class="p">.</span><span class="n">AddMap</span><span class="p">&lt;</span><span class="n">IImageWidget</span><span class="p">,</span> <span class="n">IImageWidgetViewModel</span><span class="p">&gt;()</span>
    <span class="p">.</span><span class="n">AddMap</span><span class="p">&lt;</span><span class="n">ITextWidget</span><span class="p">,</span> <span class="n">ITextWidgetViewModel</span><span class="p">&gt;();</span>
</pre></div>

<p>This will provide the following 2 mappings:</p>

<ol>
<li><p>The <strong>IImageWidget</strong> instances will be a parameter that will be used to create any instances of the <strong>IImageWidgetViewModel</strong>.</p></li>
<li><p>The <strong>ITextWidget</strong> instances will be a parameter that will be used to create any instances of the <strong>ITextWidgetViewModel</strong>.</p></li>
</ol><h2>
<a name="details" class="anchor" href="#details"><span class="octicon octicon-link"></span></a>Details</h2>

<p>Calling the <strong>RegisterFactory</strong> method actually creates an instance of a <strong>MappingFactory</strong> clas and registers the instance of that class for the lifetime of the container. The class maintains a Dictionary of mappings that were added and utilizes the <a href="http://msdn.microsoft.com/en-us/library/ff660794.aspx">IUnityContainer.Resolve()</a> method to create the requested object passing in the original object using the <a href="http://msdn.microsoft.com/en-us/library/ff660920.aspx">DependencyOverride</a> parameter.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">UnityMappingFactory maintained by <a href="https://github.com/jigamiller">jigamiller</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-41997399-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
